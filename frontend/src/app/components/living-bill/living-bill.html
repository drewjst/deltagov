<div class="h-full flex flex-col">
  <!-- Bill Header -->
  <div class="p-4 border-b border-border">
    <div class="flex items-center gap-3 mb-2">
      <lucide-icon [img]="FileTextIcon" class="h-5 w-5 text-primary" />
      <h1 class="text-lg font-semibold">H.R. 1234 - Federal Budget Act of 2025</h1>
    </div>
    <div class="flex items-center gap-4 text-sm text-muted-foreground">
      <div class="flex items-center gap-1">
        <lucide-icon [img]="UserIcon" class="h-4 w-4" />
        <span>Rep. Jane Smith (D-CA)</span>
      </div>
      <div class="flex items-center gap-1">
        <lucide-icon [img]="CalendarIcon" class="h-4 w-4" />
        <span>Updated Dec 15, 2025</span>
      </div>
    </div>
  </div>

  <!-- Version Selector -->
  <div class="p-4 border-b border-border bg-secondary/50">
    <div class="flex items-center gap-4">
      <div class="flex items-center gap-2">
        <lucide-icon [img]="GitCompareIcon" class="h-4 w-4 text-muted-foreground" />
        <span class="text-sm text-muted-foreground">Comparing:</span>
      </div>

      <!-- From Version Select -->
      <brn-select
        [ngModel]="store.selectedFromVersion()"
        (ngModelChange)="onFromVersionChange($event)"
        placeholder="Select version"
      >
        <hlm-select-trigger class="w-44">
          <hlm-select-value />
        </hlm-select-trigger>
        <hlm-select-content>
          @for (version of store.fromVersionOptions(); track version.id) {
            <hlm-option [value]="version.id">{{ version.label }}</hlm-option>
          }
        </hlm-select-content>
      </brn-select>

      <span class="text-muted-foreground">â†’</span>

      <!-- To Version Select -->
      <brn-select
        [ngModel]="store.selectedToVersion()"
        (ngModelChange)="onToVersionChange($event)"
        placeholder="Select version"
      >
        <hlm-select-trigger class="w-44">
          <hlm-select-value />
        </hlm-select-trigger>
        <hlm-select-content>
          @for (version of store.toVersionOptions(); track version.id) {
            <hlm-option [value]="version.id">{{ version.label }}</hlm-option>
          }
        </hlm-select-content>
      </brn-select>
    </div>
  </div>

  <!-- Diff Content with Virtual Scrolling -->
  <cdk-virtual-scroll-viewport
    itemSize="30"
    class="flex-1 font-mono text-sm p-4"
  >
    <div *cdkVirtualFor="let line of store.diffLines(); trackBy: trackByLine" class="mb-0.5">
      @switch (line.type) {
        @case ('deletion') {
          <div class="px-3 py-1 rounded bg-red-500/20 text-red-400 line-through">
            <span class="select-none mr-4 text-red-400/50">{{ line.lineNumber }}</span>
            - {{ line.text }}
          </div>
        }
        @case ('insertion') {
          <div class="px-3 py-1 rounded bg-green-500/20 text-green-400">
            <span class="select-none mr-4 text-green-400/50">{{ line.lineNumber }}</span>
            + {{ line.text }}
          </div>
        }
        @default {
          <div class="px-3 py-1 rounded bg-muted/30 text-muted-foreground">
            <span class="select-none mr-4 text-muted-foreground/50">{{ line.lineNumber }}</span>
            {{ line.text }}
          </div>
        }
      }
    </div>
  </cdk-virtual-scroll-viewport>

  <!-- Diff Stats Footer -->
  <div class="p-3 border-t border-border bg-secondary/50 flex items-center gap-4 text-sm">
    <span class="text-green-400">+{{ store.diffStats().additions }} additions</span>
    <span class="text-red-400">-{{ store.diffStats().deletions }} deletions</span>
    <span class="text-muted-foreground">{{ store.diffStats().total }} lines total</span>
  </div>
</div>
